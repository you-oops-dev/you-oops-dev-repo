# Maintainer: Marc Vidal <mvidaldp@gmail.com>
# Unofficial Maintainer: you-oops-dev <The profile (AUR) has all the contacts for communication or write to GitHub>

pkgname=adguardhome-bin
_pkgname=AdGuardHome
pkgver=0.107.69
_pkgver="v${pkgver}"
pkgrel=1
pkgdesc='Network-wide ads and trackers blocking DNS server (binary version).'
arch=('i686' 'x86_64')
url='https://github.com/AdguardTeam/AdGuardHome'
license=('GPL')
provides=("${pkgname}")
conflicts=('adguardhome')
install=adguardhome-bin.install
_releaseurl="https://wget.la/${url}/releases/download/${_pkgver}"
source=(sysusers.conf tmpfiles.conf AdGuardHome.service adguard-cert.sh)
options=('!strip' '!debug')

source_i686=("${_pkgname}-${pkgver}-i686.tar.gz::${_releaseurl}/${_pkgname}_linux_386.tar.gz")
source_x86_64=("${_pkgname}-${pkgver}-x86_64.tar.gz::${_releaseurl}/${_pkgname}_linux_amd64.tar.gz")

sha256sums_i686=('9846d676fe8af9a75293f72710f4d825e7847162dc44e617e1ef3b4b5f6a8f0e')
sha256sums_x86_64=('36d82638a30d436d18db3e6f8aaeabe8d5f684e0d451127b8d18d5553a3e5325')

sha256sums=('SKIP'
            'SKIP'
            'SKIP'
            'SKIP')

package() {
    install -Dm755 "${_pkgname}/${_pkgname}" "${pkgdir}/var/lib/adguardhome/${_pkgname}"
    install -Dm644 "${_pkgname}.service" "${pkgdir}/usr/lib/systemd/system/${_pkgname}.service"
    install -Dm644 "${srcdir}/sysusers.conf" "${pkgdir}/usr/lib/sysusers.d/${_pkgname}.conf"
    install -Dm644 "${srcdir}/tmpfiles.conf" "${pkgdir}/usr/lib/tmpfiles.d/${_pkgname}.conf"
    install -Dm755 "${srcdir}/adguard-cert.sh" "${pkgdir}/usr/local/bin/adguard-cert.sh"
}